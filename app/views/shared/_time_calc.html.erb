<% @beg_range = @beg_range.to_date %>
<% @end_range = @end_range.to_date %>

<!-- month Calculations -->
<!-- get range to go back to week -->
<% @resource_m = request.path.split('/')[1] %>

<% if @resource_m == "monthly_scrapbook" %>
	<% if @user.images.where(date_taken: @beg_range..@end_range, month: true).order("date_taken ASC").any? %>
		<% @month_images = @user.images.where(date_taken: @beg_range..@end_range, month: true).order("date_taken ASC") %>
		<% m_img_num = @month_images[0].date_taken.strftime("%d").to_i/7 %>
		<% @beg_month_image_range = @month_images[0].date_taken.beginning_of_month+m_img_num.weeks %>
	<% else %>
		<% @beg_month_image_range = @beg_range.beginning_of_month %>
	<% end %>
<% end %>

<!-- Determine Day -->
<% if @resource_m == "weekly_scrapbook" %>
	<% if @user.images.where(date_taken: @beg_range..@end_range, week: true).order("date_taken ASC").any? %>
		<% @week_images = @user.images.where(date_taken: @beg_range..@end_range, week: true).order("date_taken ASC") %>
		<% @first_week_image_date = @week_images[0].date_taken %>
	<% end %>
<% end %>

<!-- day Calculations -->
	<!-- finding which week day belongs to -->
<% num = (@beg_range.strftime("%d").to_i-1)/7 %>
<% @beg_range_week = @beg_range.beginning_of_month+num.weeks %>
<% @end_range_week = @beg_range.beginning_of_month+num.weeks+6.days %>

<!-- week Calculations -->

<% @first_of_month = @beg_range.to_date.beginning_of_month %>
<% @last_of_month = @beg_range.to_date.beginning_of_month.next_month-1 %>

<% if (@end_range+7).between?(@first_of_month, @last_of_month) %>
	<% if @beg_range.between?(@beg_range.prev_month.end_of_month, @beg_range.beginning_of_month+1) %>
		<!--1st Week-->
		<% @beg_of_prev_week = @beg_range.prev_month.beginning_of_month + 4.weeks %>
		<% @end_of_prev_week = @end_range.prev_month.end_of_month %>
		
		<% @beg_of_next_week = @beg_range+7.days %>
		<% @end_of_next_week = @end_range+7.days %>
	<% else %>
		<!--Middle Weeks-->
		<% @beg_of_prev_week = @beg_range-7.days %>
		<% @end_of_prev_week = @end_range-7.days %>
		
		<% @beg_of_next_week = @beg_range+7.days %>
		<% @end_of_next_week = @end_range+7.days %>
	<% end %>
<% elsif %>
	<% if @beg_range.next_week.beginning_of_week.between?(@first_of_month, @last_of_month) %>
		<!--4th Week-->
		<% @beg_of_prev_week = @beg_range-7.days %>
		<% @end_of_prev_week = @end_range-7.days %>
		
		<% @beg_of_next_week = @beg_range+7.days %>
		<% @end_of_next_week = @end_range.end_of_month %>	
	<% else %>
		<!--5th Week-->
		<% @beg_of_prev_week = @beg_range-7.days %>
		<% @end_of_prev_week = @end_range-2.days %>
		
		<% @beg_of_next_week = @beg_range.next_month.beginning_of_month %>
		<% @end_of_next_week = @end_range.next_week.beginning_of_month+6.days %>
	<% end %>
<% end %>

