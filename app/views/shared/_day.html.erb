<%= render('shared/time_calc', beg_range: @beg_range) %>

<%= link_to content_tag(:div, "Go To Week", class: "nav_up"), weekly_scrapbook_path(beg_range: @beg_range_week, end_range: @end_range_week) %>

<% image_num = 0 %>

<% @user_images.each do |image| %>
<!-- determine day -->
<% beg_week = image.date_taken.beginning_of_week.strftime("%Y-%m-%d")%>
<% end_week = image.date_taken.end_of_week.strftime("%Y-%m-%d") %>
<% beg_month = image.date_taken.beginning_of_month.strftime("%Y-%m-%d") %>
	
	<li>
		<div class="image_container image_position" id="image_<%= image_num += 1 %>">
			<%= image_tag image.image_url, width:175, height:175 %>
			
			<div class="actions hide">	
				<div class="gallery_msg">				
				<% if image.week == false %>
					<%= form_for [@user, image], remote: true do |f| %>
					  <%= f.check_box :week %>
					  Add to your week
					<% end %>
					
				<% elsif image.week == true %>
					<%= link_to content_tag(:div, "Part of weekly Gallery"), weekly_scrapbook_path(beg_range: beg_week, end_week: end_week) %>
				<% end %>
				</div>	
				<%= render('shared/edit_delete_image_container', :image => image) %>	
			</div>
		</div>
	</li>
<% end %>

 
	<!-- journal_container -->
<div class="journal_container">
		
	<% @user_journals.each do |entry| %>	
			<div class="journal_entry">
				<%= content_tag :p, entry.content %>
								
				<%= link_to image_tag("delete.png", width: 15, height: 15), [@user, entry ], :confirm => 'Are you sure?', :method => :delete, class: "scrap_image_X" %>
				<%= link_to "Edit", [:edit, @user, entry] %>
			</div>
			
	<% end %>	
</div>

<div class="nav_arrows">
	<div class="prev prev-next direction">
	    <%= link_to content_tag(:div,"prev", class: "prev_btn"), daily_scrapbook_path(beg_range: @beg_range.to_date-1, end_range: @beg_range.to_date-1), remote: true %>
	</div>
	<div class="next prev-next direction">
	    <%= link_to content_tag(:div,"next", class: "next_btn"), daily_scrapbook_path(beg_range: @beg_range.to_date+1, end_range: @beg_range.to_date+1), remote: true %>
	</div>
</div>

<ul class="dom_container">
	<div class="centered">
	
	<% (@beg_range.to_date.beginning_of_month..@beg_range.to_date.end_of_month).each do |day| %>
		<!--  Pointer : add pointer class -->
		<% if @beg_range.to_date == day %>
			
			<% if @user.images.where(date_taken: day..day).any? %>
				<%= link_to content_tag(:li, day.strftime("%d"), class: "days_of_month clickable_dates content_exists pointer"), daily_scrapbook_path(beg_range: day, end_range: day), remote: true %>
			<% else %>
				<%= link_to content_tag(:li, day.strftime("%d"), class: "days_of_month clickable_dates pointer"), daily_scrapbook_path(beg_range: day, end_range: day), remote: true %>

			<% end %>
		<!--  Future days : add future_date class  -->	
		<% elsif Date.today < day %>
				<%= link_to content_tag(:li, day.strftime("%d"), class: "days_of_month clickable_dates future_date"), daily_scrapbook_path(beg_range: day, end_range: day), remote: true %>
		<!--  Future days : no extra classes  -->	
		<% else %>
			<% if @user.images.where(date_taken: day..day).any? %>
				<%= link_to content_tag(:li, day.strftime("%d"), class: "days_of_month clickable_dates content_exists"), daily_scrapbook_path(beg_range: day, end_range: day), remote: true %>
			<% else %>
				<%= link_to content_tag(:li, day.strftime("%d"), class: "days_of_month clickable_dates"), daily_scrapbook_path(beg_range: day, end_range: day), remote: true %>

			<% end %>
		<% end %>
	<% end %>
	</div>
</ul>

<%= render('menus/by_week', :beg_month => @first_of_month ) %>

<%= render('menus/by_month', :beg_range => @first_of_month ) %>