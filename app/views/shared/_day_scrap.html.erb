<!-- Add a photo dropdown -->
<li class="drop-image outside_add hot_form image_outside">
	<a class="" href="#" >Add a photo<strong class="caret"></strong></a>
</li>
<li class="drop-journal outside_add hot_form journal_outside">
	<a class="" href="#" >Journal Entry<strong class="caret"></strong></a>
</li>
<div class="image_form hide form_style">
	<%= render 'images/form' %>
</div>
<div class="journal_form hide form_style">
	<%= render 'journals/form' %>
</div>

<!-- this is a testing area to make sure variable are rendering correctly -->
<div class="test_container">
	<div class="test1" ></div>
	<div class="test2" ></div>
	<div class="test3"></div>
</div>

<div class="submission_nav">
	<ul>
		<%= link_to content_tag(:li, "day"), "#", class: "day_sub" %>
		<%= link_to content_tag(:li, "week"), "#", class: "week_sub"%>
		<%= link_to content_tag(:li, "month"), "#", class: "month_sub" %>
		<%= link_to content_tag(:li, "year"), "#", class: "year_sub" %>
	</ul>
</div>
 
<!-- End photo dropdown -->

<!-- set up parameters for months array -->
	<% date = Date.today %>

	<% def start_month(m) %>
		<% date = Date.today %>
		<% @beg_month = date.beginning_of_month %>
		<% @beg_month << m %> 
	<% end %>
	
	<!-- set up parameters for weeks array -->

	<% def start_week(m) %>
		<% date = Date.today %>
		<% beg_month = date.beginning_of_month %>
		<% @start_dates = [] %>
		<% actual_month = beg_month << m %>
		<% (1..5).each do |w| %>
			<% @start_dates << actual_month+((w*7)-7) %> 
		<% end %>
		<% @start_dates %>
	<% end %>

	<% def end_week(m) %>
		<% date = Date.today %>
		<% beg_month = date.beginning_of_month %>
		<% @end_dates = [] %>
		<% actual_month = beg_month << m %>
		<% (1..5).each do |w| %>
			<% @end_dates << actual_month+((w*7)-1) %> 
		<% end %>
		<% @end_dates %>
	<% end %>

	<% def is_numeric?(s) %>
   	 <% !!Float(s) rescue false %>
	<% end %>

	
		
	

<!-- Day Container holding images and journal entries -->
<div class="day_submissions submissions">
	<%= render 'shared/day_submissions' %>
</div>

<div class="week_submissions submissions">
	<ul>
	<% @days.uniq.sort.each do |d| %>
		<!-- get w value -->
		<% nice_date = d.strftime('%d').to_i %>
		<% w = nice_date/7 %>

		<!-- get m value -->
		<% date1 = Date.today %>
		<% date2 = Date.today.beginning_of_month %>
		<% breaker = date1.strftime("%d").to_i %> <!-- today's number day of month -->
		
			<!-- days of current month -->
		<% count = (date1.beginning_of_month..(date1.next_month.beginning_of_month-1)).count %>
		<% answer = distance_of_time_in_words(date1, d) %>
		<% number = answer.split(' ')[0].to_i %>
		<% word = answer.split(' ')[1] %>
		    <!-- test if we are in present month-set m to 0 -->
		<% if number < breaker %>
			
			<% m = 0 %>
		<% else %>
			<!-- get into next month and get a clean num for how many months away -->
			<% date3 = Date.today.next_month-number+1 %>
			<% answer2 = distance_of_time_in_words(date3, d) %>
			<% number2 = answer2.split(' ') %>
			<% for num in number2 do %>
				<% if is_numeric?(num) %>
					<% m = num.to_i %>
				<% end %>
			<% end %>
			
		<% end %>
		<% m %>
		<br />
		
		<div class="week_container" id="<%= start_week(m)[w] %>-<%= end_week(m)[w] %>">
			
			<!-- <div class="scrapbook"></div> -->
			<!-- Add a photo dropdown -->	
			<li class="drop-image hot_form" >
				<a class="" href="#" >Add a photo<strong class="caret"></strong></a>
			</li>
			<!-- End photo dropdown -->

			<!-- Add a journal-entry dropdown -->
			<li class="drop-journal hot_form">
				<a class="" href="#" >Journal Entry<strong class="caret"></strong></a>
			</li>
			<!-- End journal-entry dropdown -->

			
			<!-- photos_container -->
			<div class="photos_container">
				<% @images = @user.images.find(:all, :conditions => {:date_taken => start_week(m)[w]..end_week(m)[w], week: true}) %>
				<% for image in @images do %>
					<li>
					<div class="image_container">
						<%= image_tag image.image_url, width:175, height:175 %>
						<%= content_tag :h3, image.title %>
						<%= content_tag :p, image.content, class: "image_content" %>
						<div class="actions">					
						<%= link_to image_tag("delete.png", width: 15, height: 15), [@user, image ], :confirm => 'Are you sure?', :method => :delete, class: "image_X" %>
						<%= link_to "Edit", [:edit, @user, image] %>
						</div>
					</div>
					</li>
				<% end %>
			</div>	
		</div>
	<% end %>
	</ul>

	

	<br />
	
	

	<!-- Current month with weeks on bottom, show when page is loaded -->
	<div class="month-of-year current_month" id="<%= start_month(0).strftime('%b') %>">
	    <h2 id="month">
	        <a class="prev prev-next" title="<%= start_month(1) %>"><</a>
	        
	    </h2>

	    <ul class="dom_container">
	    <% (0..4).each do |d| %>
	    	<% if @user.images.find(:all, :conditions => {:date_taken => start_week(0)[d]..end_week(0)[d], week: true}).any? %>
	    	 	<a href="#"><li class="weeks_of_month" style="background:#C8DAF1;"  data-start-week="<%= start_week(0)[d] %>" data-end-week="<%= end_week(0)[d] %>" data-exists="yes" >Week <%= d+1 %></li></a>
	    	<% else %>
	         	<a href="#"><li class="weeks_of_month" data-start-week="<%= start_week(0)[d] %>" data-end-week="<%= end_week(0)[d] %>" data-exists="no" >Week <%= d+1 %></li></a>
	        <% end %>
	    <% end %>
	    </ul>
	</div>

	<!-- scrolling through month array --> 
	<% (1..12).each do |m| %>
	<div class="month-of-year" id="<%= start_week(m)[0] %>">
		<h2 id="month">
	        <a class="prev prev-next" title="<%= start_month(m+1) %>"><</a>
	        <a class="next prev-next" title="<%= start_month(m-1) %>">></a>   
	    </h2>
		
		<ul class="dom_container">
		<% (0..4).each do |w| %>
	    	<% if @user.images.find(:all, :conditions => {:date_taken => start_week(m)[w]..end_week(m)[w], week: true}).any? %>
	    	 	<a href="#"><li class="weeks_of_month" style="background:#C8DAF1;"  data-exists="yes" >Week <%= w+1 %></li></a>
	    	<% else %>
	         	<a href="#"><li class="weeks_of_month"  data-exists="no" >Week <%= w+1 %></li></a>
	        <% end %>
	    <% end %>
		</ul>
	</div>
	<% end %>
</div>

<br class="clear" />

